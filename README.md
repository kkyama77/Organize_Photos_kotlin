# Organize Photos - 写真管理アプリケーション

**Kotlin Multiplatform 製のデスクトップ向け写真管理アプリケーションです。**

##  主な機能

### 基本機能
-  **フォルダ選択と再帰的スキャン** - 指定フォルダ配下の写真を自動検索
-  **EXIF メタデータ抽出** - カメラ情報、GPS、撮影条件などを自動読み取り
-  **サムネイル表示とキャッシュ** - 高速表示と効率的なメモリ管理
-  **ダブルクリックでデフォルトアプリ起動** - 写真をすぐに開ける

### 検索機能
-  **複数キーワード検索** - AND/OR 切り替え可能
-  **日本語/英語表記ゆれ対応** - カタカナ↔ひらがな、全角↔半角、同義語展開
-  **撮影情報フィルター** - EXIF詳細検索（カメラ機種、レンズ、ISO、絞り値等）
-  **複合検索** - 簡易検索 + 撮影情報フィルターの同時利用

### 並べ替え機能（v1.0.2 新機能）
-  **9パターンの並べ替え**
  - ファイル名順（昇順・降順）
  - 撮影日順（新しい順・古い順）
  - 作成日時順（新しい順・古い順）
  - カメラ機種順
  - 焦点距離順（長い順・短い順）
  - F値順（大きい順・小さい順）
  - ISO感度順（高い順・低い順）
  - ファイル種類順
  - 向き順（縦・横）

### メタデータ管理
-  **ユーザーメタデータ編集** - タイトル、タグ、コメントを追加
-  **XMPサイドカー保存** - `.xmp/` フォルダに保存（写真ファイル本体は変更しない）
-  **安全設計** - 写真の破損リスクなし
-  **ポータブル** - 写真と `.xmp/` フォルダをまとめて移動可能

### UI/UX
-  **右クリックメニュー** - プロパティ編集、デフォルトアプリで開く
-  **スクロール位置保持** - メタデータ編集後も表示位置を維持
-  **フィルター状態表示** - 選択中のフィルター数を表示
-  **最適化されたウィンドウサイズ** - 1400x900 dp

---

##  ダウンロード

### Windows (JRE 17 同梱)
- `OrganizePhotos-1.0.3.msi` (約 57 MB)
- Java のインストール不要
- ダブルクリックでインストール完了

### Linux (Debian/Ubuntu)
- `organize-photos_1.0.3-1_amd64.deb` (JRE 17 同梱)
```bash
sudo dpkg -i organize-photos_1.0.3-1_amd64.deb
```

### Android (APK)
- `composeApp-debug.apk`
- 端末にインストールして利用

### JAR ファイル（Java 17以上が必要）
- `OrganizePhotos-1.0.3.jar`
```bash
java -jar OrganizePhotos-1.0.3.jar
```

---

## 🆕 v1.0.3 の新機能・改善

### Android 版の追加
- **Android アプリ版を追加** - フォルダ選択、写真表示、EXIF 読み取り、外部アプリで開く
- **フォルダ選択の安定化** - 選択フォルダの反映と再スキャンの挙動を改善
- **ファイル名変更対応** - MediaStore を使った安全なリネームと権限要求

### Android 版の未対応機能（デスクトップとの差分）
- **XMP サイドカー保存** - Android では未対応
- **右クリックメニュー** - Android では未対応（長押し/コンテキストメニュー無し）
- **高度な撮影情報フィルター** - 一部 UI/操作が未対応

### デスクトップの改善
- **フォルダ選択を統一** - Windows 固有処理を削除し、JFileChooser に統一
- **UI 改善** - 右クリックメニューの整理、サムネイルサイズ選択の追加

---

## 🆕 v1.0.2 の新機能・改善

### 並べ替え機能の追加
- **9パターンの並べ替え** - ファイル名、撮影日、作成日時、カメラ機種、焦点距離、F値、ISO感度、ファイル種類、向きで並べ替え
- **自動スクロールリセット** - 並べ替え後に表示位置がトップに戻る

### 撮影情報フィルターの改善
- **選択状態の保持** - フィルターパネルを折りたたんでも選択が維持される
- **選択数の表示** - カテゴリ見出しに選択中のフィルター数を表示（例：カメラ情報（2個選択中））
- **ボタン文言改善** - 「撮影情報フィルターをたたむ / 開く」に変更

### 内部改善
- PhotoItem に `modifiedAt` フィールド追加（ファイル更新日時）
- SortService.kt による統一的なソートロジック実装

---

##  v1.0.0 → v1.0.3 の変更履歴

### v1.0.1 の変更点
- 日本語/英語表記ゆれ対策（カタカナ↔ひらがな統一、全角↔半角統一、同義語展開）
- XMPサイドカー対応（メタデータをポータブルに保存）
- 撮影情報フィルター（EXIF詳細検索）
- 複合検索（簡易検索 + 撮影情報フィルター）
- スクロール位置保持
- UI最適化（ウィンドウサイズ、テキストサイズ）

### v1.0.3 の変更点（今回のリリース）
- Android 版を追加
- フォルダ選択・再スキャンの安定化
- Android のファイル名変更（MediaStore）対応
- Windows フォルダ選択処理の簡素化
- サムネイルサイズ選択の追加

### v1.0.2 の変更点
- 並べ替え機能追加（9パターン）
- 撮影情報フィルターの折りたたみ挙動改善
- カテゴリ選択数表示

---

##  必要な環境

- **Windows**: Windows 10/11 (64-bit)
- **Linux**: Ubuntu 20.04 LTS 以上、または同等の Debian 系ディストリビューション
- **JAR**: Java Runtime Environment (JRE) 17 以上

---

##  使い方

1. **フォルダ選択** - 「フォルダ選択」ボタンをクリックして写真フォルダを指定
2. **自動スキャン** - 配下の写真を自動検索（JPEG、PNG、HEIC、TIFF 対応）
3. **検索・フィルター** - キーワード検索や撮影情報フィルターで絞り込み
4. **並べ替え** - ドロップダウンから並べ替えパターンを選択
5. **メタデータ編集** - 右クリック → プロパティで タイトル・タグ・コメントを追加

---

##  対応プラットフォーム

- ✅ **Windows 10/11** - 完全対応（MSIインストーラー）
- ✅ **Linux (Debian/Ubuntu)** - 完全対応（Debパッケージ）
- ✅ **macOS** - JARファイルで実行可能
- ✅ **Android** - APK で提供
- ⏳ **iOS** - 次回リリース予定

---

## � アップグレード方法

### Windows
- 新しい MSI ファイルをダブルクリックするだけで、古いバージョンが自動的にアンインストールされ、新バージョンがインストールされます
- 設定やメタデータ（XMPファイル）は保持されます

### Linux
```bash
sudo dpkg -i organize-photos_1.0.3-1_amd64.deb
```
- 古いバージョンが自動的に置き換えられます

### Android
- 新しい APK をインストール（上書きインストールでOK）

### JAR
- 古い JAR ファイルを削除してから、新しい JAR ファイルを配置してください

---

##  初期表示順序

- **v1.0.2 以降**: フォルダスキャン後は **ファイル名順（昇順）** で表示されます
- **v1.0.1 までの動作**: ファイルシステムの走査順（不規則）で表示されていました
- **並べ替え**: ドロップダウンから別の並び順を選択できます

---

##  セキュリティとプライバシー

- ✅ **ローカル保存** - クラウド送信なし、すべてローカルで処理
- ✅ **安全設計** - 写真ファイル本体は変更しない（XMPサイドカー方式）
- ✅ **オープンソース** - コードは GitHub で公開

---

##  ビルド方法（開発者向け）

### 前提条件
- JDK 17
- Gradle 8.7

### デスクトップ実行
```bash
./gradlew :composeApp:run
# または
./gradle-8.7/bin/gradle :composeApp:run
```

### Windows MSI 作成
```bash
./gradlew :composeApp:packageMsi
```

### Linux Deb 作成（Linux環境で実行）
```bash
./gradlew :composeApp:packageDeb
```

---

##  ライセンス

MIT License

Copyright © 2026 kkyama77

---

##  コントリビューション

Issue や Pull Request を歓迎します。

GitHub: https://github.com/kkyama77/Organize_Photos_kotlin

---

##  お問い合わせ

バグ報告や機能リクエストは GitHub Issues でお願いします。

---

##  謝辞

- **metadata-extractor** - Drew Noakes 氏による EXIF 読み取りライブラリ
- **Compose Multiplatform** - JetBrains による UI フレームワーク
- **Kotlin** - JetBrains によるプログラミング言語
